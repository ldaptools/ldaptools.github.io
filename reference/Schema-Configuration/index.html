<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Chad Sikorra">
        <link rel="canonical" href="http://www.phpldaptools.com/reference/Schema-Configuration/">
        <link rel="shortcut icon" href="../../img/favicon.ico">

        <title>Schema Configuration - LdapTools</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">LdapTools</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../Attribute-Converters">Attribute Converters</a>
                            </li>
                        
                            <li >
                                <a href="../Default-Schema-Attributes">Default Schema Attributes</a>
                            </li>
                        
                            <li >
                                <a href="../Events">Events</a>
                            </li>
                        
                            <li >
                                <a href="../Main-Configuration">Main Configuration</a>
                            </li>
                        
                            <li class="active">
                                <a href=".">Schema Configuration</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cookbook <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../cookbook/Authenticating-a-User">Authenticating a User</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/Common-LDAP-Queries">Common LDAP Queries</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/Creating-a-Custom-Repository">Creating a Custom Repository</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/Modifying-GPO-Links-on-OUs">Modifying GPO Links on OUs</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../tutorials/AD-User-Modification">AD User Modification</a>
                            </li>
                        
                            <li >
                                <a href="../../tutorials/Building-LDAP-Queries">Building LDAP Queries</a>
                            </li>
                        
                            <li >
                                <a href="../../tutorials/Creating-AD-Password-Settings-Objects">Creating AD Password Settings Objects</a>
                            </li>
                        
                            <li >
                                <a href="../../tutorials/Creating-LDAP-Objects">Creating LDAP Objects</a>
                            </li>
                        
                            <li >
                                <a href="../../tutorials/Modifying-LDAP-Objects">Modifying LDAP Objects</a>
                            </li>
                        
                            <li >
                                <a href="../../tutorials/Using-the-LDAP-Manager">Using the LDAP Manager</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                </ul>
            

            
            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                <li >
                    <a rel="next" href="../Main-Configuration">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../../cookbook/Authenticating-a-User">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                
                <li>
                    <a href="https://github.com/ldaptools/ldaptools/">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
            
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#schema-configuration">Schema Configuration</a></li>
        
            <li><a href="#schema-file-structure-yaml">Schema File Structure (YAML)</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="schema-configuration">Schema Configuration</h1>
<hr />
<p>LdapTools uses a schema definition to describe various LDAP objects in your directory service. This allows you to easily
create and modify any part of the schema to suit your needs. Default schema definitions are included in the 
<code>resources/schema</code> directory in the root of this library. Both OpenLDAP and Active Directory have default schema files.</p>
<p>The schema definition allows you to abstract the LDAP schema so you can refer to objects by whatever name and attribute
names that you want within this class. It also allows you to assign attribute converters to LDAP attributes so you can 
convert the data in LDAP to the way you want it to be displayed in PHP, and vice-versa.</p>
<p>The following serves as a reference for the structure of a schema and the possible configuration directives.</p>
<h2 id="schema-file-structure-yaml">Schema File Structure (YAML)</h2>
<p>The schema YAML file is structured as follows:</p>
<pre><code class="yaml"># This name must always be defined
objects:
    # This name can be whatever you want, but must be unique for this section of the YAML.
    user_object:
        # ... Schema object directives are defined here
    # Another schema object definition
    group_object:
        # ... More object directives are defined here
</code></pre>

<h3 id="schema-configuration-options">Schema Configuration Options</h3>
<hr />
<h4 id="objects-required">objects <strong><em>(Required)</em></strong></h4>
<p>Underneath the <code>objects</code> is where you define all your schema object definitions. This option must be defined.</p>
<h4 id="extends_default">extends_default</h4>
<hr />
<p>By using this option you can specify the name of one of the default schemas to extend. Any options contained within that
schema will be merged into your schema. To add additional options to existing schema types the keys underneath "objects"
must match between the default schema and your own!</p>
<pre><code class="yaml"># Extends the default 'ad' schema included within the 'resources/schema' directory.
extends_default: ad
objects:
    # This 'user' key must exist in the default schema for it to merge, otherwise it will be considered a new object type.
    user:
        # Sets a custom repository definition for the user object, in addition to everything else in the default schema.
        repository: '\My\Custom\Repository'
</code></pre>

<h3 id="schema-object-configuration-options">Schema Object Configuration Options</h3>
<hr />
<h4 id="type-required">type <strong><em>(Required)</em></strong></h4>
<p>The name for the type is how you will refer to this LDAP schema object within the class. This is a required field. 
Default LDAP object types that the class has defined are: <code>user</code>, <code>group</code>, <code>computer</code>, <code>contact</code>.</p>
<hr />
<h4 id="class">class</h4>
<p>This is the <code>objectClass</code> value for the LDAP object you're defining. It can be any valid LDAP objectClass value (<code>user</code>,
<code>inetOrgPerson</code>, <code>group</code>, etc) and will be used in the creation of LDAP query filters when using this type. This can be
either a single string, or an array with multiple class names.</p>
<hr />
<h4 id="category">category</h4>
<p>This is the <code>objectCategory</code> value for the LDAP object you're defining. It can be any valid LDAP
objectCategory value (<code>person</code>, <code>computer</code>, <code>contact</code>, etc) and will be used in the creation of LDAP query filters 
(along with the <code>class</code> definition above) when using this type.</p>
<hr />
<h4 id="attributes">attributes</h4>
<p>These should be <code>key: value</code> pairs. Where the <code>key</code> is the name you would like the refer to the LDAP attribute by 
within the class, and the <code>value</code> is the name of the attribute in LDAP (ie. <code>firstName: givenName</code>).</p>
<hr />
<h4 id="converters">converters</h4>
<p>These should defined as keys with the converters name with an array of attribute name values:</p>
<pre><code class="yaml">    windows_generalized_time:
        - 'created'
        - 'modified'
</code></pre>

<p>The attribute names can either be the schema defined attribute name, or the actual LDAP attribute name. For a 
complete listing of possible built-in attribute converters, see this <a href="../Attribute-Converters">reference doc</a>.</p>
<hr />
<h4 id="converter_options">converter_options</h4>
<p>These should defined as keys with the converters name with an array of options that will be passed to the converter:</p>
<pre><code class="yaml">    converter_options:
        user_account_control:
            defaultValue: '512'
            uacMap:
                disabled: '2'
                passwordNeverExpires: '65536'
                smartCardRequired: '262144'
                trustedForDelegation: '262144'
                passwordIsReversible: '128'
</code></pre>

<p>This results in an array with the keys <code>defaultValue</code> and <code>uacMap</code> (and their respective arrays) being passed to the
converter. These options are accessible from within the attribute converter by using <code>$this-&gt;options</code>.</p>
<hr />
<h4 id="attributes_to_select">attributes_to_select</h4>
<p>An array of attributes that will be selected by default on LDAP queries when using this type.</p>
<pre><code class="yaml">    attributes_to_select:
        - 'firstName'
        - 'lastName'
        - 'guid'
</code></pre>

<hr />
<h4 id="multivalued_attributes">multivalued_attributes</h4>
<p>An array of attributes that are expected to be multivalued. Setting this for an attribute will force it to always return
an array value regardless of the number of values it has. This allows for more predictable results.</p>
<pre><code class="yaml">    multivalued_attributes:
        - 'otherHomePhone'
        - 'otherIpPhone'
</code></pre>

<hr />
<h4 id="repository">repository</h4>
<p>The full class name (ie <code>\MyNamespace\MyClasses\CustomRepository</code>) to use as the default repository when calling
 <code>getRepository('object_type')</code> on the <code>LdapManager</code> class. The class must extend <code>\LdapTools\Object\LdapObjectRepository</code>.</p>
<hr />
<h4 id="default_values">default_values</h4>
<p>An array of attributes with what their default value should be set to whe creating this object using the 
<code>LdapObjectCreator</code>. These values also accept parameter values encased within <code>%</code> symbols that can resolve to other 
attribute values.</p>
<pre><code class="yaml">    default_values:
        firstName: &quot;%username%&quot;
        displayName: &quot;%lastName%, %firstName%&quot;
        description: &quot;%displayName%: Located in %city%&quot;
        city: &quot;Utah&quot;
</code></pre>

<hr />
<h4 id="required_attributes">required_attributes</h4>
<p>An array of attributes that are required when creating this object type. If these are not present, an exception will be
thrown. This will only happen if they are not specified on creation and not contained within the <code>default_values</code> list.</p>
<pre><code class="yaml">    required_attributes:
        - 'username'
        - 'password'
        - 'firstName'
        - 'lastName'
</code></pre>

<hr />
<h4 id="default_container">default_container</h4>
<p>This should be a string in DN format that represents the OU/container where new objects for this LDAP type should be
placed by default when created.</p>
<pre><code class="yaml">    default_container: 'OU=Accounting,OU=Employees,DC=example,DC=local'
</code></pre>

<hr />
<h4 id="extends">extends</h4>
<p>By using this option you can explicitly state to make a object type extend another object and inherit everything it
already has defined. This value can either be a string, meaning that the object to extend already exists within the
current schema, or it can be an array. The array must be like <code>[ schema, object ]</code>, where <code>schema</code> is the name of a 
separate schema file within the same schema folder and <code>object</code> is the name of a defined object type within that schema. </p>
<pre><code class="yaml">objects:
    user:
        # A bunch of stuff defined...
    custom_user:
        # Tells it to 'extend' the user type defined above and inherit its properties.
        extends: user
        # Make sure the define a different type!
        type: custom_user
    another_user:
        # Tells it to look in the schema file called 'custom' for the object type 'user' and extend that.
        extends: [ custom, user ]
        type: another_user
</code></pre>

<hr />
<h4 id="extends_default_1">extends_default</h4>
<p>By using this option you can tell the schema to extend a specific object type from a default schema, either <code>ad</code> or 
<code>openldap</code>. This helps you to avoid repetition when configuring your own schema yet still customize it to your needs.
This value must be an array that contains the default schema name and object type to extend.</p>
<pre><code class="yaml">objects:
    special_user:
        # Extends the default AD user type.
        extends_default: [ ad, user ]
        type: special_user
        # Put these accounts in a specific OU
        default_container: 'ou=special accounts,dc=example,dc=local'
        # Add an additional attribute to select.
        attributes_to_select:
            - 'title'
</code></pre>

</div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Copyright &copy; 2015, Chad Sikorra.</p>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/prettify-1.0.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>