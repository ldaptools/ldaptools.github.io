<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Chad Sikorra">
        <link rel="canonical" href="http://www.phpldaptools.com/tutorials/Modifying-LDAP-Objects/">
        <link rel="shortcut icon" href="../../img/favicon.ico">

        <title>Modifying LDAP Objects - LdapTools</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">LdapTools</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cookbook <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../cookbook/Authenticating-a-User">Authenticating a User</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/Common-LDAP-Queries">Common LDAP Queries</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/Creating-a-Custom-Repository">Creating a Custom Repository</a>
                            </li>
                        
                            <li >
                                <a href="../../cookbook/Modifying-GPO-Links-on-OUs">Modifying GPO Links on OUs</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../AD-User-Modification">AD User Modification</a>
                            </li>
                        
                            <li >
                                <a href="../Building-LDAP-Queries">Building LDAP Queries</a>
                            </li>
                        
                            <li >
                                <a href="../Creating-AD-Password-Settings-Objects">Creating AD Password Settings Objects</a>
                            </li>
                        
                            <li >
                                <a href="../Creating-LDAP-Objects">Creating LDAP Objects</a>
                            </li>
                        
                            <li >
                                <a href="../LDIF-Files">LDIF Files</a>
                            </li>
                        
                            <li class="active">
                                <a href=".">Modifying LDAP Objects</a>
                            </li>
                        
                            <li >
                                <a href="../Using-the-LDAP-Manager">Using the LDAP Manager</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../reference/Attribute-Converters">Attribute Converters</a>
                            </li>
                        
                            <li >
                                <a href="../../reference/Default-Schema-Attributes">Default Schema Attributes</a>
                            </li>
                        
                            <li >
                                <a href="../../reference/Events">Events</a>
                            </li>
                        
                            <li >
                                <a href="../../reference/Logging">Logging</a>
                            </li>
                        
                            <li >
                                <a href="../../reference/Main-Configuration">Main Configuration</a>
                            </li>
                        
                            <li >
                                <a href="../../reference/Schema-Configuration">Schema Configuration</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                </ul>
            

            
            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                <li >
                    <a rel="next" href="../LDIF-Files">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../Using-the-LDAP-Manager">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                
                <li>
                    <a href="https://github.com/ldaptools/ldaptools/">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
            
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#modifying-ldap-objects">Modifying LDAP Objects</a></li>
        
            <li><a href="#automatic-setters-and-getters">Automatic Setters and Getters</a></li>
        
            <li><a href="#automatic-property-access">Automatic Property Access</a></li>
        
            <li><a href="#standard-method-access">Standard Method Access</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="modifying-ldap-objects">Modifying LDAP Objects</h1>
<hr />
<p>Modifying an existing LDAP object is as easy as searching for it, making your changes to the object via either the 
setters/properties then sending the object back to the <code>LdapManager</code> class with the <code>persist()</code> method. All the changes
you make to the object are tracked and when you call <code>persist()</code> it will only update the attributes you actually changed.</p>
<p>Please keep in mind that this is not an active record design. The <code>LdapObject</code> instance is only aware of properties
you explicitly selected as part of the LDAP query. So if you want to check if an attribute exists, or has a specific value,
then make sure to actually select the attribute when you query LDAP. If you selected the attribute as part of the query,
but the <code>has($attribute)</code> method returns false, then the attribute is not set.</p>
<p>A simple example:</p>
<pre><code class="php">use LdapTools\Object\LdapObjectType;

//...

$repository = $ldap-&gt;getRepository(LdapObjectType::USER);

$user = $repository-&gt;findOneByUsername('chad');

// Replaces the current title with whatever you choose.
$user-&gt;setTitle('CEO');
// Resets whatever value might have been set to this attribute.
$user-&gt;resetMobilePhone();
// Remove a specific value from a multi-valued attribute. Careful! If it doesn't exist LDAP will complain.
$user-&gt;removePhoneNumber('555-5555');
// Remove multiple values for a multi-valued attribute at once (Using splat notation)...
$user-&gt;removePhoneNumber(...['555-5555', '123-4567', '765-4321']);
// Adds a value to an attribute in addition to what it might already have
$user-&gt;addIpPhone('#001-1000');
// Add multiple values at once...
$user-&gt;addIpPhone('#001-1234','#002-5678', '#003-1001');

// Check if a specific attribute exists
if ($user-&gt;hasEmailAddress()) {
    // do something....
}

// Check if an attribute with a specific value exists
if ($user-&gt;hasState('WI')) {
    // do something else....
}

// Now actually save the changes back to LDAP
try {
    $ldap-&gt;persist($user);
} catch (\Exception $e) {
    echo &quot;Error updating user! &quot;.$e-&gt;getMessage();
}
</code></pre>

<h2 id="automatic-setters-and-getters">Automatic Setters and Getters</h2>
<p>When you search for and retrieve an object in LDAP you will get an <code>LdapObject</code> instance by default. This class has
several "magic" PHP methods defined to make your life easier. You can get/set any attribute by its actual schema name
just as if it had an actual setter defined. So to get the <code>firstName</code> attribute you can call <code>getFirstName()</code>. And
to change it you simply call <code>setFirstName($firstName)</code>.</p>
<p>However, be sure to check if the attribute exists in the returned object first by calling <code>has($attributeName)</code>
before trying to actually get its value.</p>
<h2 id="automatic-property-access">Automatic Property Access</h2>
<p>In addition to the automatic setters/getters mentioned above, you can also access attributes by simply accessing them as
if they were public properties on the object. Behind the scenes it still tracks any changes you might make by setting a 
property this way.</p>
<pre><code>// Instead of '$user-&gt;getFirstName()' ...
echo &quot;First Name:&quot;.$user-&gt;firstName.PHP_EOL;
echo &quot;Last Name:&quot;.$user-&gt;lastName.PHP_EOL;

// Or set them this way too, which is equivalent to calling: $user-&gt;setFirstName('Some Dude')
$user-&gt;firstName = 'Fred';
$user-&gt;lastName = 'Fuchs';

// You can also call isset on a property to determine if it exists on the object...
if (isset($user&gt;phoneNumber)) {
    echo &quot;Phone: &quot;.$user-&gt;phoneNumber.PHP_EOL; 
}
</code></pre>

<hr />
<h2 id="standard-method-access">Standard Method Access</h2>
<p>In Addition to all of the easy automatic property/setters/getters described above, you can also do it through more
verbose methods. All of the below methods are ultimately what the automatic methods use to do everything behind the
scenes.</p>
<hr />
<h4 id="setattribute-value">set($attribute, $value)</h4>
<p>Replaces any value that might exist in the attribute with the value you specify.</p>
<hr />
<h4 id="addattribute-value">add($attribute, ...$value)</h4>
<p>Adds a value to an attribute in addition to what it already may have. It will keep the existing value intact. This
method is also variadic, so you can pass as many values you want as arguments to this function.</p>
<hr />
<h4 id="removeattribute-value">remove($attribute, ...$value)</h4>
<p>Remove a specific value from an attribute. Be careful with this. If the value does not actually exist within the
attribute then an exception will be thrown during persist. It's best to wrap persist in a try/catch block. This
method is also variadic, so you can pass as many values you want as arguments to this function.</p>
<hr />
<h4 id="resetattribute">reset($attribute)</h4>
<p>Resets an attribute by removing any values it may contain.</p>
<hr />
<h4 id="hasattribute-value-null">has($attribute, $value = null)</h4>
<p>Check for the existence of an attribute before you attempt to retrieve its value. If you attempt to get the value of a
non-existent attribute then it will throw an exception. You can optionally specify a value check as well. In that case 
the attribute must exist and it must have the specified value for it to return <code>true</code>.</p>
</div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Copyright &copy; 2015, Chad Sikorra.</p>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/prettify-1.0.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>